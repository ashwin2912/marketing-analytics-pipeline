2025-09-05 07:24:50,362 - INFO - ============================================================
2025-09-05 07:24:50,362 - INFO - STARTING MASTER DATA PIPELINE
2025-09-05 07:24:50,362 - INFO - ============================================================
2025-09-05 07:24:50,364 - INFO - Starting Layer 1: Staging Pipeline...
2025-09-05 07:24:50,364 - INFO - Staging schema created successfully
2025-09-05 07:24:50,364 - INFO - Starting raw data ingestion...
2025-09-05 07:24:50,440 - INFO - Successfully loaded 40000 rows to stg_sales_raw
2025-09-05 07:24:50,457 - INFO - Starting data cleaning and validation...
2025-09-05 07:24:50,487 - INFO - Data quality flag 'VALID': 40000 records
2025-09-05 07:24:50,502 - INFO - Staging pipeline completed successfully: {'raw_records': 40000, 'cleaned_records': 40000, 'quality_breakdown': {'VALID': 40000}, 'date_range': {'min': '2021-01-01', 'max': '2022-11-16'}}
2025-09-05 07:24:50,502 - INFO - Layer 1 completed successfully
2025-09-05 07:24:50,502 - INFO - Starting Layer 2: Data Warehouse Pipeline...
2025-09-05 07:24:50,502 - INFO - Data warehouse schema created successfully
2025-09-05 07:24:50,502 - INFO - Building date dimension...
2025-09-05 07:24:50,616 - INFO - Date dimension built successfully with 685 rows
2025-09-05 07:24:50,616 - INFO - Building customer dimension...
2025-09-05 07:24:50,730 - INFO - Customer dimension built successfully with 33477 rows
2025-09-05 07:24:50,730 - INFO - Building order dimension...
2025-09-05 07:24:50,924 - INFO - Order dimension built successfully with 40000 rows
2025-09-05 07:24:50,924 - INFO - Building sales fact table...
2025-09-05 07:24:51,043 - INFO - Sales fact table built successfully with 40000 rows
2025-09-05 07:24:51,057 - INFO - Warehouse pipeline completed successfully: {'dim_date_rows': 685, 'dim_customer_rows': 33477, 'dim_order_rows': 40000, 'fact_sales_rows': 40000, 'unique_customers': 33477, 'total_transactions': 40000, 'total_revenue': 6709020.43, 'avg_transaction_value': 167.73}
2025-09-05 07:24:51,057 - INFO - Layer 2 completed successfully
2025-09-05 07:24:51,057 - INFO - Starting Layer 3: Business Analysis Pipeline...
2025-09-05 07:24:51,057 - INFO - Business analysis schema created successfully
2025-09-05 07:24:51,057 - INFO - Building monthly metrics...
2025-09-05 07:24:51,077 - INFO - Monthly metrics built successfully with 23 rows
2025-09-05 07:24:51,077 - INFO - Building cohort analysis...
2025-09-05 07:24:51,116 - INFO - Cohort analysis built successfully with 276 rows
2025-09-05 07:24:51,116 - INFO - Building customer LTV analysis...
2025-09-05 07:25:13,567 - INFO - Customer LTV analysis built successfully with 33477 rows
2025-09-05 07:25:13,568 - INFO - Building campaign targets...
2025-09-05 07:25:13,643 - INFO - Campaign targets built successfully with 28753 rows
2025-09-05 07:25:13,643 - INFO - Generating business insights...
2025-09-05 07:25:13,646 - INFO - Generated 3 business insights
2025-09-05 07:25:13,647 - INFO - Business analysis pipeline completed successfully: {'monthly_metrics_rows': 23, 'cohort_analysis_rows': 276, 'customer_ltv_analysis_rows': 33477, 'campaign_targets_rows': 28753, 'business_insights_rows': 3, 'active_campaigns': 0, 'total_campaign_value': 0, 'total_insights': 3, 'high_priority_insights': 2}
2025-09-05 07:25:13,648 - INFO - Layer 3 completed successfully
2025-09-05 07:25:13,648 - INFO - ============================================================
2025-09-05 07:25:13,648 - INFO - MASTER PIPELINE COMPLETED SUCCESSFULLY
2025-09-05 07:25:13,648 - INFO - Total duration: 23.29 seconds
2025-09-05 07:25:13,648 - INFO - ============================================================
2025-09-05 07:25:13,648 - INFO - Closed staging database connection
2025-09-05 07:25:13,648 - INFO - Closed warehouse database connection
2025-09-05 07:25:13,649 - INFO - Closed business database connection
2025-09-05 07:25:13,649 - INFO - Closed metadata database connection
2025-09-05 07:32:24,740 - INFO - ============================================================
2025-09-05 07:32:24,740 - INFO - STARTING MASTER DATA PIPELINE
2025-09-05 07:32:24,740 - INFO - ============================================================
2025-09-05 07:32:24,742 - INFO - Starting Layer 1: Staging Pipeline...
2025-09-05 07:32:24,743 - INFO - Staging schema created successfully
2025-09-05 07:32:24,743 - INFO - Starting raw data ingestion...
2025-09-05 07:32:24,813 - INFO - Successfully loaded 40000 rows to stg_sales_raw
2025-09-05 07:32:24,828 - INFO - Starting data cleaning and validation...
2025-09-05 07:32:24,844 - INFO - Data quality flag 'VALID': 40000 records
2025-09-05 07:32:24,859 - INFO - Staging pipeline completed successfully: {'raw_records': 40000, 'cleaned_records': 40000, 'quality_breakdown': {'VALID': 40000}, 'date_range': {'min': '2021-01-01', 'max': '2022-11-16'}}
2025-09-05 07:32:24,859 - INFO - Layer 1 completed successfully
2025-09-05 07:32:24,859 - INFO - Starting Layer 2: Data Warehouse Pipeline...
2025-09-05 07:32:24,860 - INFO - Data warehouse schema created successfully
2025-09-05 07:32:24,860 - INFO - Building date dimension...
2025-09-05 07:32:24,974 - INFO - Date dimension built successfully with 685 rows
2025-09-05 07:32:24,974 - INFO - Building customer dimension...
2025-09-05 07:32:25,084 - INFO - Customer dimension built successfully with 33477 rows
2025-09-05 07:32:25,084 - INFO - Building order dimension...
2025-09-05 07:32:25,277 - INFO - Order dimension built successfully with 40000 rows
2025-09-05 07:32:25,277 - INFO - Building sales fact table...
2025-09-05 07:32:25,325 - INFO - Sales fact table built successfully with 40000 rows
2025-09-05 07:32:25,339 - INFO - Warehouse pipeline completed successfully: {'dim_date_rows': 685, 'dim_customer_rows': 33477, 'dim_order_rows': 40000, 'fact_sales_rows': 40000, 'unique_customers': 33477, 'total_transactions': 40000, 'total_revenue': 6709020.43, 'avg_transaction_value': 167.73}
2025-09-05 07:32:25,339 - INFO - Layer 2 completed successfully
2025-09-05 07:32:25,339 - INFO - Starting Layer 3: Business Analysis Pipeline...
2025-09-05 07:32:25,341 - INFO - Business analysis schema created successfully
2025-09-05 07:32:25,341 - INFO - Building monthly metrics...
2025-09-05 07:32:25,362 - INFO - Monthly metrics built successfully with 23 rows
2025-09-05 07:32:25,362 - INFO - Building cohort analysis...
2025-09-05 07:32:25,407 - INFO - Cohort analysis built successfully with 276 rows
2025-09-05 07:32:25,407 - INFO - Building customer LTV analysis...
2025-09-05 07:32:47,784 - INFO - Customer LTV analysis built successfully with 33477 rows
2025-09-05 07:32:47,784 - INFO - Building campaign targets...
2025-09-05 07:32:47,838 - INFO - Campaign targets built successfully with 28753 rows
2025-09-05 07:32:47,838 - INFO - Generating business insights...
2025-09-05 07:32:47,841 - INFO - Generated 3 business insights
2025-09-05 07:32:47,842 - INFO - Business analysis pipeline completed successfully: {'monthly_metrics_rows': 23, 'cohort_analysis_rows': 276, 'customer_ltv_analysis_rows': 33477, 'campaign_targets_rows': 28753, 'business_insights_rows': 3, 'active_campaigns': 0, 'total_campaign_value': 0, 'total_insights': 3, 'high_priority_insights': 2}
2025-09-05 07:32:47,842 - INFO - Layer 3 completed successfully
2025-09-05 07:32:47,842 - INFO - ============================================================
2025-09-05 07:32:47,842 - INFO - MASTER PIPELINE COMPLETED SUCCESSFULLY
2025-09-05 07:32:47,842 - INFO - Total duration: 23.10 seconds
2025-09-05 07:32:47,842 - INFO - ============================================================
2025-09-05 07:32:47,843 - INFO - Closed staging database connection
2025-09-05 07:32:47,843 - INFO - Closed warehouse database connection
2025-09-05 07:32:47,843 - INFO - Closed business database connection
2025-09-05 07:32:47,843 - INFO - Closed metadata database connection
2025-09-05 07:32:47,843 - ERROR - Data quality summary error: Cannot operate on a closed database.
2025-09-05 07:41:32,503 - INFO - ============================================================
2025-09-05 07:41:32,503 - INFO - STARTING MASTER DATA PIPELINE
2025-09-05 07:41:32,503 - INFO - ============================================================
2025-09-05 07:41:32,510 - INFO - Starting Layer 1: Staging Pipeline...
2025-09-05 07:41:32,511 - INFO - Staging schema created successfully
2025-09-05 07:41:32,511 - INFO - Starting raw data ingestion...
2025-09-05 07:41:32,587 - INFO - Successfully loaded 40000 rows to stg_sales_raw
2025-09-05 07:41:32,603 - INFO - Starting data cleaning and validation...
2025-09-05 07:41:32,625 - INFO - Data quality flag 'VALID': 40000 records
2025-09-05 07:41:32,638 - INFO - Staging pipeline completed successfully: {'raw_records': 40000, 'cleaned_records': 40000, 'quality_breakdown': {'VALID': 40000}, 'date_range': {'min': '2021-01-01', 'max': '2022-11-16'}}
2025-09-05 07:41:32,638 - INFO - Layer 1 completed successfully
2025-09-05 07:41:32,638 - INFO - Starting Layer 2: Data Warehouse Pipeline...
2025-09-05 07:41:32,638 - INFO - Data warehouse schema created successfully
2025-09-05 07:41:32,638 - INFO - Building date dimension...
2025-09-05 07:41:32,745 - INFO - Date dimension built successfully with 685 rows
2025-09-05 07:41:32,745 - INFO - Building customer dimension...
2025-09-05 07:41:32,856 - INFO - Customer dimension built successfully with 33477 rows
2025-09-05 07:41:32,856 - INFO - Building order dimension...
2025-09-05 07:41:33,049 - INFO - Order dimension built successfully with 40000 rows
2025-09-05 07:41:33,049 - INFO - Building sales fact table...
2025-09-05 07:41:33,154 - INFO - Sales fact table built successfully with 40000 rows
2025-09-05 07:41:33,171 - INFO - Warehouse pipeline completed successfully: {'dim_date_rows': 685, 'dim_customer_rows': 33477, 'dim_order_rows': 40000, 'fact_sales_rows': 40000, 'unique_customers': 33477, 'total_transactions': 40000, 'total_revenue': 6709020.43, 'avg_transaction_value': 167.73}
2025-09-05 07:41:33,171 - INFO - Layer 2 completed successfully
2025-09-05 07:41:33,171 - INFO - Starting Layer 3: Business Analysis Pipeline...
2025-09-05 07:41:33,174 - INFO - Business analysis schema created successfully
2025-09-05 07:41:33,174 - INFO - Building monthly metrics...
2025-09-05 07:41:33,197 - INFO - Monthly metrics built successfully with 23 rows
2025-09-05 07:41:33,197 - INFO - Building cohort analysis...
2025-09-05 07:41:33,236 - INFO - Cohort analysis built successfully with 276 rows
2025-09-05 07:41:33,236 - INFO - Building customer LTV analysis...
2025-09-05 07:41:55,509 - INFO - Customer LTV analysis built successfully with 33477 rows
2025-09-05 07:41:55,509 - INFO - Building campaign targets...
2025-09-05 07:41:55,580 - INFO - Campaign targets built successfully with 28753 rows
2025-09-05 07:41:55,580 - INFO - Generating business insights...
2025-09-05 07:41:55,583 - INFO - Generated 3 business insights
2025-09-05 07:41:55,584 - INFO - Business analysis pipeline completed successfully: {'monthly_metrics_rows': 23, 'cohort_analysis_rows': 276, 'customer_ltv_analysis_rows': 33477, 'campaign_targets_rows': 28753, 'business_insights_rows': 3, 'active_campaigns': 0, 'total_campaign_value': 0, 'total_insights': 3, 'high_priority_insights': 2}
2025-09-05 07:41:55,584 - INFO - Layer 3 completed successfully
2025-09-05 07:41:55,584 - INFO - ============================================================
2025-09-05 07:41:55,584 - INFO - MASTER PIPELINE COMPLETED SUCCESSFULLY
2025-09-05 07:41:55,584 - INFO - Total duration: 23.08 seconds
2025-09-05 07:41:55,584 - INFO - ============================================================
2025-09-05 07:41:55,585 - INFO - Closed staging database connection
2025-09-05 07:41:55,585 - INFO - Closed warehouse database connection
2025-09-05 07:41:55,585 - INFO - Closed business database connection
2025-09-05 07:41:55,585 - INFO - Closed metadata database connection
2025-09-05 07:41:55,585 - ERROR - Data quality summary error: Cannot operate on a closed database.
