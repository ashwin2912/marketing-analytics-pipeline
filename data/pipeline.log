2025-09-05 06:53:41,613 - INFO - Staging schema created successfully
2025-09-05 06:53:41,613 - INFO - Starting raw data ingestion...
2025-09-05 06:53:41,690 - INFO - Successfully loaded 40000 rows to stg_sales_raw
2025-09-05 06:53:41,712 - INFO - Starting data cleaning and validation...
2025-09-05 06:53:41,769 - INFO - Data quality flag 'VALID': 200000 records
2025-09-05 06:53:41,841 - INFO - Staging pipeline completed successfully: {'raw_records': 40000, 'cleaned_records': 200000, 'quality_breakdown': {'VALID': 200000}, 'date_range': {'min': '2021-01-01', 'max': '2022-11-16'}}
2025-09-05 06:53:41,857 - INFO - Closed staging database connection
2025-09-05 06:53:41,857 - INFO - Closed warehouse database connection
2025-09-05 06:53:41,857 - INFO - Closed business database connection
2025-09-05 06:53:41,857 - INFO - Closed metadata database connection
2025-09-05 06:54:29,240 - INFO - Staging schema created successfully
2025-09-05 06:54:29,240 - INFO - Starting raw data ingestion...
2025-09-05 06:54:29,326 - INFO - Successfully loaded 40000 rows to stg_sales_raw
2025-09-05 06:54:29,347 - INFO - Starting data cleaning and validation...
2025-09-05 06:54:29,377 - INFO - Data quality flag 'VALID': 40000 records
2025-09-05 06:54:29,390 - INFO - Staging pipeline completed successfully: {'raw_records': 40000, 'cleaned_records': 40000, 'quality_breakdown': {'VALID': 40000}, 'date_range': {'min': '2021-01-01', 'max': '2022-11-16'}}
2025-09-05 06:54:29,391 - INFO - Closed staging database connection
2025-09-05 06:54:29,391 - INFO - Closed warehouse database connection
2025-09-05 06:54:29,391 - INFO - Closed business database connection
2025-09-05 06:54:29,391 - INFO - Closed metadata database connection
2025-09-05 06:54:29,391 - INFO - Data warehouse schema created successfully
2025-09-05 06:54:29,391 - INFO - Building date dimension...
2025-09-05 06:54:29,395 - ERROR - Failed to build date dimension: datatype mismatch
2025-09-05 06:54:29,395 - ERROR - Warehouse pipeline failed: datatype mismatch
2025-09-05 14:11:00,348 - INFO - Business analysis schema created successfully
2025-09-05 14:11:00,348 - INFO - Building monthly metrics...
2025-09-05 14:11:00,378 - INFO - Monthly metrics built successfully with 23 rows
2025-09-05 14:11:00,378 - INFO - Building cohort analysis...
2025-09-05 14:11:00,465 - INFO - Cohort analysis built successfully with 276 rows
2025-09-05 14:11:00,465 - INFO - Building cumulative retention analysis...
2025-09-05 14:11:00,582 - INFO - Cumulative retention analysis built with 69 rows
2025-09-05 14:11:00,582 - INFO - Building customer LTV analysis...
2025-09-05 14:11:22,982 - INFO - Customer LTV analysis built successfully with 33477 rows
2025-09-05 14:11:22,984 - INFO - Building customer segmentation...
2025-09-05 14:11:23,060 - INFO - Customer segmentation built with 33477 rows
2025-09-05 14:11:23,060 - INFO - Building seasonal trends...
2025-09-05 14:11:23,065 - INFO - Seasonal trends built with 12 rows
2025-09-05 14:11:23,065 - INFO - Building customer lifecycle snapshot...
2025-09-05 14:11:23,084 - INFO - Customer lifecycle snapshot built for 2022-11-16 with 1 rows.
2025-09-05 14:11:23,084 - INFO - Building campaign targets...
2025-09-05 14:11:23,145 - INFO - Campaign targets built successfully with 28753 rows
2025-09-05 14:11:23,145 - INFO - Generating business insights...
2025-09-05 14:11:23,152 - INFO - Generated 6 business insights
2025-09-05 14:11:23,159 - INFO - Business analysis pipeline completed successfully: {'monthly_metrics_rows': 23, 'cohort_analysis_rows': 276, 'cumulative_retention_analysis_rows': 69, 'customer_ltv_analysis_rows': 33477, 'customer_segmentation_rows': 33477, 'seasonal_trends_rows': 12, 'campaign_targets_rows': 28753, 'business_insights_rows': 6, 'customer_lifecycle_snapshot_rows': 1, 'active_campaigns': 0, 'total_campaign_value': 0, 'total_insights': 6, 'high_priority_insights': 4, 'champions_customers': 0, 'at_risk_customers': 20085}
2025-09-05 14:11:23,180 - INFO - Closed staging database connection
2025-09-05 14:11:23,180 - INFO - Closed warehouse database connection
2025-09-05 14:11:23,180 - INFO - Closed business database connection
2025-09-05 14:11:23,181 - INFO - Closed metadata database connection
2025-09-05 14:13:22,869 - INFO - Business analysis schema created successfully
2025-09-05 14:13:22,869 - INFO - Building monthly metrics...
2025-09-05 14:13:22,898 - INFO - Monthly metrics built successfully with 23 rows
2025-09-05 14:13:22,898 - INFO - Building cohort analysis...
2025-09-05 14:13:22,983 - INFO - Cohort analysis built successfully with 276 rows
2025-09-05 14:13:22,983 - INFO - Building cumulative retention analysis...
2025-09-05 14:13:23,098 - INFO - Cumulative retention analysis built with 69 rows
2025-09-05 14:13:23,098 - INFO - Building customer LTV analysis...
2025-09-05 14:13:45,295 - INFO - Customer LTV analysis built successfully with 33477 rows
2025-09-05 14:13:45,295 - INFO - Building customer segmentation...
2025-09-05 14:13:45,369 - INFO - Customer segmentation built with 33477 rows
2025-09-05 14:13:45,369 - INFO - Building seasonal trends...
2025-09-05 14:13:45,370 - INFO - Seasonal trends built with 12 rows
2025-09-05 14:13:45,370 - INFO - Building customer lifecycle snapshot...
2025-09-05 14:13:45,381 - INFO - Customer lifecycle snapshot built for 2022-11-16 with 1 rows.
2025-09-05 14:13:45,381 - INFO - Building campaign targets...
2025-09-05 14:13:45,439 - INFO - Campaign targets built successfully with 28753 rows
2025-09-05 14:13:45,439 - INFO - Generating business insights...
2025-09-05 14:13:45,445 - INFO - Generated 6 business insights
2025-09-05 14:13:45,452 - INFO - Business analysis pipeline completed successfully: {'monthly_metrics_rows': 23, 'cohort_analysis_rows': 276, 'cumulative_retention_analysis_rows': 69, 'customer_ltv_analysis_rows': 33477, 'customer_segmentation_rows': 33477, 'seasonal_trends_rows': 12, 'campaign_targets_rows': 28753, 'business_insights_rows': 6, 'customer_lifecycle_snapshot_rows': 1, 'active_campaigns': 0, 'total_campaign_value': 0, 'total_insights': 6, 'high_priority_insights': 4, 'champions_customers': 0, 'at_risk_customers': 20085}
2025-09-05 14:20:04,932 - INFO - Business analysis schema created successfully
2025-09-05 14:20:04,932 - INFO - Building monthly metrics...
2025-09-05 14:20:04,961 - INFO - Monthly metrics built successfully with 23 rows
2025-09-05 14:20:04,961 - INFO - Building cohort analysis...
2025-09-05 14:20:05,047 - INFO - Cohort analysis built successfully with 276 rows
2025-09-05 14:20:05,047 - INFO - Building cumulative retention analysis...
2025-09-05 14:20:05,160 - INFO - Cumulative retention analysis built with 69 rows
2025-09-05 14:20:05,160 - INFO - Building customer LTV analysis...
2025-09-05 14:20:27,458 - INFO - Customer LTV analysis built successfully with 33477 rows
2025-09-05 14:20:27,458 - INFO - Building customer segmentation...
2025-09-05 14:20:27,545 - INFO - Customer segmentation built with 33477 rows
2025-09-05 14:20:27,549 - INFO - Building seasonal trends...
2025-09-05 14:20:27,551 - INFO - Seasonal trends built with 12 rows
2025-09-05 14:20:27,551 - INFO - Building customer lifecycle snapshot...
2025-09-05 14:20:27,568 - INFO - Customer lifecycle snapshot built for 2022-11-16 with 1 rows.
2025-09-05 14:20:27,568 - INFO - Building campaign targets...
2025-09-05 14:20:27,629 - INFO - Campaign targets built successfully with 28753 rows
2025-09-05 14:20:27,629 - INFO - Generating business insights...
2025-09-05 14:20:27,639 - INFO - Generated 6 business insights
2025-09-05 14:20:27,646 - INFO - Business analysis pipeline completed successfully: {'monthly_metrics_rows': 23, 'cohort_analysis_rows': 276, 'cumulative_retention_analysis_rows': 69, 'customer_ltv_analysis_rows': 33477, 'customer_segmentation_rows': 33477, 'seasonal_trends_rows': 12, 'campaign_targets_rows': 28753, 'business_insights_rows': 6, 'customer_lifecycle_snapshot_rows': 1, 'active_campaigns': 0, 'total_campaign_value': 0, 'total_insights': 6, 'high_priority_insights': 4, 'champions_customers': 25, 'at_risk_customers': 16502}
2025-09-05 14:20:27,670 - INFO - Closed staging database connection
2025-09-05 14:20:27,670 - INFO - Closed warehouse database connection
2025-09-05 14:20:27,671 - INFO - Closed business database connection
2025-09-05 14:20:27,671 - INFO - Closed metadata database connection
